# 发票易 - 使用说明

## 快速开始

### 1. 启动后端服务器

**Windows:**
```bash
start_backend.bat
```

**Linux/Mac:**
```bash
chmod +x start_backend.sh
./start_backend.sh
```

或者手动启动：
```bash
cd backend
python app.py
```

后端将在 `http://localhost:5000` 启动

### 2. 启动前端开发服务器

**Windows:**
```bash
start_frontend.bat
```

**Linux/Mac:**
```bash
chmod +x start_frontend.sh
./start_frontend.sh
```

或者手动启动：
```bash
cd frontend
npm install  # 首次运行需要安装依赖
npm run dev
```

前端将在 `http://localhost:3000` 启动

## 功能使用

### 上传发票

1. 点击右上角"批量上传发票"按钮
2. 可以选择一个或多个PDF或图片文件（支持格式：PDF、PNG、JPG、JPEG、GIF、BMP、WEBP）
   - 按住 `Ctrl` 键（Windows）或 `Cmd` 键（Mac）可以选择多个文件
   - 也可以直接拖拽多个文件到文件选择对话框
3. 系统会自动批量上传所有选中的文件
4. 上传完成后，文件会自动出现在"待处理发票相关文件"列表中
5. 如果部分文件上传失败，会显示详细的错误信息

### 处理发票

1. 在"待处理发票相关文件"列表中点击发票卡片
2. 进入处理页面：
   - **左侧**：文件预览区域
     - 图片：支持放大缩小（点击 +/- 按钮）
     - PDF：在iframe中显示，支持浏览器内置缩放
   - **右侧**：信息填写表单
     - 类别：选择餐费、住宿、交通或研发费用（必填）
     - 金额：输入金额，单位RMB（必填）
     - 附件：输入附件名称，多个用逗号分隔（如：行程单,详情）
     - 备注：填写备注信息
3. 填写完成后点击"提交"按钮
4. 发票会自动移动到"已处理发票"列表

### 编辑已处理发票

1. 在"已处理发票"列表中点击发票卡片
2. 修改信息后点击"提交"保存
3. 或点击"还原为未处理"将发票还原为未处理状态

### 删除发票

1. 在发票卡片上点击"删除"按钮
2. 确认删除后，发票和文件都会被删除

### 导出报销单

1. 点击右上角"导出报销单"按钮
2. 系统会导出所有已处理发票为CSV格式
3. CSV文件包含：
   - 按类别分组的发票记录
   - 每个类别的统计小计
   - 总计金额
   - 文件名、金额、附件、备注等信息

## 注意事项

- 确保后端服务器先启动，前端才能正常工作
- 上传的文件大小限制为16MB
- 删除发票会同时删除文件，请谨慎操作
- 导出功能只导出状态为"已完成"的发票

## 常见问题

**Q: 上传文件失败？**
A: 检查文件格式是否支持，文件大小是否超过16MB

**Q: 预览PDF不显示？**
A: 确保后端服务器正常运行，检查浏览器控制台是否有错误

**Q: 导出功能不工作？**
A: 确保有至少一张已处理的发票，检查浏览器是否阻止了下载

**Q: 前端页面无法加载？**
A: 确保后端服务器在 `http://localhost:5000` 运行，前端在 `http://localhost:3000` 运行

